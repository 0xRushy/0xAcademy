# الهجمات الإرثيه (القديمة) - Legacy Attacks

بالنظر إلى عمر البلوتوث

تم اكتشاف العديد من هجمات البلوتوث ونقاط الضعف الأكثر شهرة والتي يتم الاستشهاد بها بشكل متكرر في أوائل العقد الأول من القرن الحادي والعشرين وحتى منتصفه

<hr>

## 1 - Bluejacking 

يشير Bluejacking إلى هجوم قديم يتضمن إرسال رسائل غير مرغوب فيها إلى الأجهزة التي تدعم تقنية بلوتوث

على عكس Bluesnarfing، لا يتضمن Bluejacking الوصول إلى البيانات أو سرقتها من الجهاز المستهدف

وبدلاً من ذلك، يستخدم ميزة اسمها "business card" موجوده بالبلوتوث لإرسال رسائل مجهولة المصدر

غالبا تكون في شكل نص أو صور وزي كذا

<br>

<p align="center">
  <img src="https://academy.hackthebox.com/storage/modules/230/K600i_Bluejacked.jpg" width="400">
</p>

<br> 

الاغلب يشوفها مزح وثقاله دم أو إزعاج وليس تهديدًا أمنيًا خطيرًا

في سيناريو الـbluejacking العادي

يبدأ المخترق بالبحث عن أجهزة البلوتوث اللي حوله بعدين يختار هدفًا من الأجهزة اللي لقاها ويبدأ يصمم رسالة نصية أو يختار صورة 


وباستخدام الـ"Object Push Profile " أو الـ (OPP) يرسل رسائل أو صور غير مرغوب فيها للجهاز المستهدف


الـ(OPP) هو نوع من انواع الـProfiles حقت البلوتوث اللي تساعد على تبادل الكائنات أو الملفات البسيطة بين الأجهزة

هالكائنات قد تكون بطاقات أعمال افتراضية (vCards)، أو تقويمات (vCalendars)،  أو أشكال أخرى من البيانات

**``` ومن الجدير بالذكر أن هذه العملية كلها يمكن إنجازها دون إنشاء اتصال مقترن بالجهاز المستهدف، مما يجعل الـbluejacking عملية خفية لا تترك أي أثر سوى رسالة غير متوقعة على جهاز المستلم ```**


<hr>


<br>

اقصى شي يسويه الـbluejacking عمومًا هو الإزعاج

ولكن في بعض الحالات يمكن استخدام الـbluejacking بشكل Malicious اكثر

على سبيل المثال، يمكن استخدامه كجزء من هجوم الهندسة الاجتماعية، حيث يتم تصميم الرسالة غير المرغوب فيها لخداع المستلم للكشف عن معلومات حساسة أو أداء إجراء مثل تثبيت برامج ضارة على جهازه

<br>

مع مرور الوقت، انتشر الوعي حول الـbluejacking

وبدأت الشركات المصنعة والمطورين في تنفيذ تدابير أمان لمعالجتها، مثل تغيير الإعدادات الافتراضية

هذه التحسينات جعلت من الصعب بشكل كبير على الأفراد غير المصرح لهم انهم يسوون الـbluejacking
<hr>

<br>

كانت أجهزة Apple عرضة لهجوم مشابه جدًا لهجوم الـBluejacking عبر الـAirDrop

الـ**AirDrop** هي خدمة خاصة توفرها Apple وتسمح للمستخدمين بنقل الملفات بين أجهزة الكمبيوتر Mac وأجهزة iOS عبر الـWi-Fi و الـBluetooth، دون استخدام البريد أو جهاز تخزين كبير السعة

<br>

<p align="center">
  <img src="https://academy.hackthebox.com/storage/modules/230/ios-16-iphone-13-pro-receive-airdrop.png" width="250">
</p>

<br>

يستخدم الـAirDrop تقنية الـBluetooth لإنشاء شبكة من نوع  **peer-to-peer** بين الأجهزة

 لمشاركة ملف عبر الـAirDrop، يحدد المستخدم الاول (الي يبي يرسل) زر المشاركة الموجود على المستند أو الصورة أو صفحة الويب التي يرغب في إرسالها ويختار AirDrop ويحدد الجهاز الذي يريد المشاركة معه. 
والمستخدم الثاني عند استلامه ملف عبر AirDrop، فإنه يظهر كإشعار، مما يسمح للمستخدم الثاني إما بالقبول أو الرفض.

إذا تم قبول عنصر AirDrop الوارد، فسيتم حفظه تلقائيًا في مجلد الصور أو التنزيلات أو الملفات الخاص بالمستخدم على جهاز

<br>

ولكن مع ذلك، تم استغلال هذه الميزة لأغراض الـspamming

إذا تم إعداد الـAirDrop حقك لتلقي الملفات من الجميع،

فهذا يعني أن أي شخص ضمن نطاق الـAirDrop - حوالي 30 قدمًا (9 أمتار) - يقدر يشاركك الملفات

<br>

في الاماكن المزدحمة زي الحفلات الموسيقية أو قطارات الأنفاق أو الطائرات،

يمكن للمخترقين إرسال صور أو ملفات أخرى غير مرغوب فيها إلى أي جهاز تم إعداد الـAirDrop حقه لاستقبال الملفات من الجميع

 غالبًا يسمون ملفات السبام الي توصلك عبر الـAirDrop :
 
 _**الـAirDrop غير المرغوب فيه**_ 
 
 ومع ذلك، قامت Apple بتعديل هذي الإعدادات في iOS 16.2،
 
 حيث كان لا بد من تمكين خيار "الجميع" من اعدادات الـairdrop بشكل صريح قبل أن يقوم بتعطيل نفسه تلقائيًا بعد 10 دقائق
 
 وبالتالي يسمح فقط لجهات الاتصال الخاصة بك بإرسال ملفات

<hr>
<br>

## 2 - Bluesnarfing

الـBluesnarfing هو هجوم قديم يوفر وصول غير مصرح به إلى جهاز يدعم تقنية الـBluetooth لاستخراج المعلومات، 

ويمكن إرجاع أصوله إلى عام 2003 تقريبا

 المصطلح مشتق من الـ"snarfing" 

وهو مصطلح عام في أمان الكمبيوتر، والذي يشير إلى الحصول على البيانات بشكل غير مصرح به

ولكن الـBlue الي بالبدايه اشاره الى تقنية الـBluetooth كوسيلة للوصول

وبالتالي فإن الـBluesnarfing هي في الأساس طريقة لسرقة البيانات تستغل اتصال الـBluetooth

<br>



**يتطلب الـBluesnarfing عدة خطوات**

 1 - تبدأ العملية عندما يقوم المخترق بتحديد جهاز Bluetooth نشط وضعيف ضمن النطاق حقه.

 2 - وبعد ذلك، يستغل المهاجم ثغرة أمنية في تقنية الـBluetooth بالجهاز، مما يسمح بالوصول غير المصرح به

3 -بمجرد الحصول على الوصول، يمكن للمخترق استخراج المعلومات من الجهاز، مثل معلومات الاتصال والتقويمات ورسائل البريد الإلكتروني والرسائل النصية وحتى ملفات الوسائط

 **```والجدير بالذكر أن الهجوم يمكن تنفيذه دون تنبيه مالك الجهاز، مما يجعله استغلال خفي```**

<br>

دفعت مشكلة الـBluesnarfing المصنعين والمطورين إلى اتخاذ الإجراءات اللازمة.

أصدرت مجموعة الاهتمامات الخاصة بتقنية البلوتوث ([Bluetooth SIG](https://en.wikipedia.org/wiki/Bluetooth_Special_Interest_Group))

، وهي المنظمة المسؤولة عن تطوير وتوحيد تقنية الـBluetooth، إرشادات وإرشادات أمنية لمعالجة الثغرة الأمنية

 أصدرت الشركات المصنعة للأجهزة تحديثات وتصحيحات للبرامج الثابتة لإصلاح العيوب الأمنية وتعزيز الأمان العام لتطبيقات الـBluetooth.

 ونتيجة لهذه الجهود، أصبح الـBluesnarfing أقل انتشارًا ويعتبر أقل مشكلة بالنسبة للأجهزة الحديثة.

 <br>
 <hr>
 <br>

 ## 3 - Bluebugging

 الـBluebugging هو شكل من أشكال اختراق البلوتوث حيث يكتسب المخترق السيطرة الكاملة على جهاز يدعم البلوتوث، مما يسمح له بالوصول إلى المعلومات وتعديلها، واستخدام الجهاز لإجراء المكالمات، وإرسال الرسائل النصية، وحتى الاتصال بالإنترنت.

 يعد هذا تهديدًا أكثر خطورة وغزوًا من الـBluesnarfing و الـBluejacking

 نظرًا لمستوى التحكم الذي يوفره للمهاجم

 يشبه تنفيذ هجوم الـBluebugging تنفيذ هجوم الـBluesnarfing

1 -  بدءًا من تحديد جهاز Bluetooth نشط وضعيف داخل النطاق

2 - يستغل المهاجم بعد ذلك الثغرات الأمنية في تقنية Bluetooth بالجهاز،

 غالبًا عن طريق خداع المستخدم للاعتقاد بأنه يقترن بجهاز موثوق به أو انه يسوي Brute force لرقم الـPIN لإقران Bluetooth 

 بمجرد الوصول إلى الجهاز، يمكن للمهاجم التحكم في الجهاز بشكل أساسي كما لو كان جهازًا خاصًا به.

 <br>

## 4 - BlueSmacking

<br>
الـBlueSmacking هو هجوم لتعطيل الخدمة يعتبر نوع من انواع الـ(DoS) يستهدف أجهزة البلوتوث. يستغل الهجوم ثغرة في بروتوكول البلوتوث اسمه "L2CAP" لنقل حزم كبيرة

 وذلك باستغلال القدرات المعالجة المحدودة في بعض الأجهزة. 

كان يتم تنفيذ هجمات BlueSmacking أساسًا باستخدام أدوات برمجية متخصصة تقوم بإنشاء وإرسال العديد من حزم البلوتوث.


الأجهزة الحديثة للبلوتوث قد قامت بتنفيذ حلول برمجية وبرمجيات محسنة تمكّن من معالجة وتصفية حزم البلوتوث بشكل أفضل.

 هذه التحسينات قللت بشكل كبير من فعالية هجمات BlueSmacking وجعلتها مشكلة أقل أهمية للأجهزة الحديثة.
 <br>
 

